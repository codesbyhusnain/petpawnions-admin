{"ast":null,"code":"import _slicedToArray from\"/Users/husnainmehmood/Desktop/Work/React/PP-AdminWeb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext,useEffect}from\"react\";import{Row,Col,Button,Container,Label,UncontrolledAlert}from\"reactstrap\";import Axios from\"axios\";import ForgetPasswordPage from\"./ForgetPassword\";import{AuthContext}from\"../../AuthContext\";import Auth from\"../../Auth\";// Redux\nimport{Link,Redirect}from\"react-router-dom\";import AdminUserPool from\"./AdminUserPool\";import AuthorUserPool from\"./AuthorUserPool\";// availity-reactstrap-validation\nimport{AvForm,AvField}from\"availity-reactstrap-validation\";// import images\nimport Logo from\"./logo.png\";import\"./RegisterAdmin.scss\";import{CognitoUser,AuthenticationDetails}from\"amazon-cognito-identity-js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(){var _useContext=useContext(AuthContext),token=_useContext.token,authProtect=_useContext.authProtect;var _token=_slicedToArray(token,2),jwtToken=_token[0],setJwtToken=_token[1];var _authProtect=_slicedToArray(authProtect,2),authProtected=_authProtect[0],setAuthProtected=_authProtect[1];var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),adminLoggedIn=_useState6[0],setAdminLoggedIn=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),authorLoggedIn=_useState8[0],setAuthorLoggedIn=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),redirect=_useState10[0],setRedirect=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),step=_useState12[0],setStep=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),userType=_useState14[0],setUserType=_useState14[1];// const adminLogin = (event) => {\n//   event.preventDefault();\n//   const adminUser = new CognitoUser({\n//     Username: email,\n//     Pool: AdminUserPool,\n//   });\n//   const adminAuthDetails = new AuthenticationDetails({\n//     Username: email,\n//     Password: password,\n//   });\n//   adminUser.authenticateUser(adminAuthDetails, {\n//     onSuccess: (data) => {\n//       setAdminLoggedIn(true);\n//     },\n//     onFailure: (err) => {\n//       setAdminLoggedIn(false);\n//     },\n//     newPasswordRequired: (data) => {},\n//   });\n// };\nvar loginInfo={name:email,password:password};var authApi=\"http://3.15.82.201:3000/api/auth/login\";var userAuth=function userAuth(e){e.preventDefault();Axios.post(authApi,loginInfo).then(function(res){localStorage.setItem(\"jwtToken\",res.data.idToken.jwtToken);setJwtToken(res.data.idToken.jwtToken);Auth.login();setAdminLoggedIn(true);});};useEffect(function(){localStorage.setItem(\"jwtToken\",jwtToken);localStorage.setItem(\"authProtected\",authProtected);},[jwtToken,authProtected]);var authorLogin=function authorLogin(event){event.preventDefault();var authorUser=new CognitoUser({Username:email,Pool:AuthorUserPool});var authorAuthDetails=new AuthenticationDetails({Username:email,Password:password});authorUser.authenticateUser(authorAuthDetails,{onSuccess:function onSuccess(data){setAuthorLoggedIn(true);},onFailure:function onFailure(err){setAuthorLoggedIn(false);},newPasswordRequired:function newPasswordRequired(data){}});};// console.log(Auth.isAuthProtected());\nconsole.log(localStorage.getItem(\"jwtToken\"));return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(Container,{fluid:true,className:\"p-0\",children:/*#__PURE__*/_jsxs(Row,{className:\"g-0\",children:[/*#__PURE__*/_jsx(Col,{lg:4,children:/*#__PURE__*/_jsx(\"div\",{className:\"authentication-page-content p-4 d-flex align-items-center min-vh-100\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-100\",children:/*#__PURE__*/_jsx(Row,{className:\"justify-content-center\",children:/*#__PURE__*/_jsx(Col,{lg:9,children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"img\",{src:Logo,alt:\"\",height:\"100\",class:\"auth-logo logo-dark mx-auto\"})}),/*#__PURE__*/_jsx(\"h4\",{className:\"font-size-18 mt-4\",children:\"Welcome Back!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"Sign in to continue to Pet Pawnions.\"})]}),step===0?/*#__PURE__*/_jsx(\"h1\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"user-type\",style:{display:\"flex\",flexDirection:\"column\"},children:[/*#__PURE__*/_jsx(Button,{color:\"success\",className:\"w-md waves-effect waves-light\",type:\"submit\",onClick:function onClick(){setUserType(\"Admin\");setStep(1);},children:\"Log In as an Admin\"}),/*#__PURE__*/_jsx(\"h2\",{style:{width:\"100%\",textAlign:\"center\",borderBottom:\"1px solid #9A9483\",lineHeight:\"0.1em\",margin:\"20px 0 25px\",opacity:\"50%\"},children:/*#__PURE__*/_jsx(\"span\",{style:{backgroundColor:\"#f0f5f7\",padding:\"0 15px\",fontSize:\"12px\"},children:\"OR\"})}),/*#__PURE__*/_jsx(Button,{color:\"primary\",className:\"w-md waves-effect waves-light\",type:\"submit\",onClick:function onClick(){setUserType(\"Author\");setStep(1);},children:\"Log In as an Author\"})]})}):null,step===1?/*#__PURE__*/_jsxs(\"div\",{className:\"login-flow\",children:[adminLoggedIn?/*#__PURE__*/_jsxs(\"div\",{children:[setTimeout(function(){setRedirect(true);},2000),redirect?/*#__PURE__*/_jsx(Redirect,{to:\"/articles\"}):null]}):null,adminLoggedIn===false?/*#__PURE__*/_jsxs(UncontrolledAlert,{color:\"danger\",className:\"alert-dismissible fade show\",role:\"alert\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-alert-outline me-2\"}),\"Authentication failed! Please try again\"]}):null,authorLoggedIn?/*#__PURE__*/_jsxs(\"div\",{children:[setTimeout(function(){setRedirect(true);},2000),redirect?/*#__PURE__*/_jsx(Redirect,{to:\"/dashboard\"}):null]}):null,authorLoggedIn===false?/*#__PURE__*/_jsxs(UncontrolledAlert,{color:\"danger\",className:\"alert-dismissible fade show\",role:\"alert\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-alert-outline me-2\"}),\"Authentication failed! Please try again\"]}):null,/*#__PURE__*/_jsx(\"div\",{className:\"p-2 mt-5\",children:/*#__PURE__*/_jsxs(AvForm,{className:\"form-horizontal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"auth-form-group-custom mb-4\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"ri-user-2-line auti-custom-input-icon\"}),/*#__PURE__*/_jsx(Label,{htmlFor:\"username\",children:\"Email\"}),/*#__PURE__*/_jsx(AvField,{name:\"email\",type:\"text\",className:\"form-control\",id:\"username\",placeholder:\"Enter username\",onChange:function onChange(e){return setEmail(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"auth-form-group-custom mb-4\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"ri-lock-2-line auti-custom-input-icon\"}),/*#__PURE__*/_jsx(Label,{htmlFor:\"userpassword\",children:\"Password\"}),/*#__PURE__*/_jsx(AvField,{name:\"password\",type:\"password\",className:\"form-control\",id:\"userpassword\",placeholder:\"Enter password\",onChange:function onChange(e){return setPassword(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 text-center\",style:{display:\"flex\",justifyContent:\"space-evenly\"},children:[userType===\"Admin\"?/*#__PURE__*/_jsx(Button,{color:\"success\",className:\"w-md waves-effect waves-light\",type:\"submit\",onClick:userAuth,children:\"Log In\"}):null,userType===\"Author\"?/*#__PURE__*/_jsx(Button,{color:\"primary\",className:\"w-md waves-effect waves-light\",type:\"submit\",onClick:authorLogin,children:\"Log In\"}):null]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 text-center\",onClick:function onClick(){return setStep(3);},style:{cursor:\"pointer\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-lock me-1\"}),\" Forgot your password?\"]})]})})]}):null,step===3&&userType!==\"\"?/*#__PURE__*/_jsx(ForgetPasswordPage,{user:userType}):null]})})})})})}),/*#__PURE__*/_jsx(Col,{lg:8,children:/*#__PURE__*/_jsx(\"div\",{className:\"authentication-bg\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-overlay\"})})})]})})});};export default Login;","map":{"version":3,"sources":["/Users/husnainmehmood/Desktop/Work/React/PP-AdminWeb/src/pages/Authentication/Login.js"],"names":["React","useState","useContext","useEffect","Row","Col","Button","Container","Label","UncontrolledAlert","Axios","ForgetPasswordPage","AuthContext","Auth","Link","Redirect","AdminUserPool","AuthorUserPool","AvForm","AvField","Logo","CognitoUser","AuthenticationDetails","Login","token","authProtect","jwtToken","setJwtToken","authProtected","setAuthProtected","email","setEmail","password","setPassword","adminLoggedIn","setAdminLoggedIn","authorLoggedIn","setAuthorLoggedIn","redirect","setRedirect","step","setStep","userType","setUserType","loginInfo","name","authApi","userAuth","e","preventDefault","post","then","res","localStorage","setItem","data","idToken","login","authorLogin","event","authorUser","Username","Pool","authorAuthDetails","Password","authenticateUser","onSuccess","onFailure","err","newPasswordRequired","console","log","getItem","display","flexDirection","width","textAlign","borderBottom","lineHeight","margin","opacity","backgroundColor","padding","fontSize","setTimeout","target","value","justifyContent","cursor"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\r\n\r\nimport {\r\n  Row,\r\n  Col,\r\n  Button,\r\n  Container,\r\n  Label,\r\n  UncontrolledAlert,\r\n} from \"reactstrap\";\r\nimport Axios from \"axios\";\r\n\r\nimport ForgetPasswordPage from \"./ForgetPassword\";\r\nimport { AuthContext } from \"../../AuthContext\";\r\nimport Auth from \"../../Auth\";\r\n\r\n// Redux\r\n\r\nimport { Link, Redirect } from \"react-router-dom\";\r\nimport AdminUserPool from \"./AdminUserPool\";\r\nimport AuthorUserPool from \"./AuthorUserPool\";\r\n\r\n// availity-reactstrap-validation\r\nimport { AvForm, AvField } from \"availity-reactstrap-validation\";\r\n\r\n// import images\r\nimport Logo from \"./logo.png\";\r\n\r\nimport \"./RegisterAdmin.scss\";\r\n\r\nimport { CognitoUser, AuthenticationDetails } from \"amazon-cognito-identity-js\";\r\n\r\nconst Login = () => {\r\n  const { token, authProtect } = useContext(AuthContext);\r\n  const [jwtToken, setJwtToken] = token;\r\n  const [authProtected, setAuthProtected] = authProtect;\r\n\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [adminLoggedIn, setAdminLoggedIn] = useState();\r\n  const [authorLoggedIn, setAuthorLoggedIn] = useState();\r\n  const [redirect, setRedirect] = useState(false);\r\n  const [step, setStep] = useState(0);\r\n  const [userType, setUserType] = useState(\"\");\r\n\r\n  // const adminLogin = (event) => {\r\n  //   event.preventDefault();\r\n\r\n  //   const adminUser = new CognitoUser({\r\n  //     Username: email,\r\n  //     Pool: AdminUserPool,\r\n  //   });\r\n\r\n  //   const adminAuthDetails = new AuthenticationDetails({\r\n  //     Username: email,\r\n  //     Password: password,\r\n  //   });\r\n\r\n  //   adminUser.authenticateUser(adminAuthDetails, {\r\n  //     onSuccess: (data) => {\r\n  //       setAdminLoggedIn(true);\r\n  //     },\r\n  //     onFailure: (err) => {\r\n  //       setAdminLoggedIn(false);\r\n  //     },\r\n  //     newPasswordRequired: (data) => {},\r\n  //   });\r\n  // };\r\n\r\n  const loginInfo = {\r\n    name: email,\r\n    password: password,\r\n  };\r\n\r\n  const authApi = \"http://3.15.82.201:3000/api/auth/login\";\r\n  const userAuth = (e) => {\r\n    e.preventDefault();\r\n    Axios.post(authApi, loginInfo).then((res) => {\r\n      localStorage.setItem(\"jwtToken\", res.data.idToken.jwtToken);\r\n      setJwtToken(res.data.idToken.jwtToken);\r\n      Auth.login();\r\n      setAdminLoggedIn(true);\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem(\"jwtToken\", jwtToken);\r\n    localStorage.setItem(\"authProtected\", authProtected);\r\n  }, [jwtToken, authProtected]);\r\n\r\n  const authorLogin = (event) => {\r\n    event.preventDefault();\r\n\r\n    const authorUser = new CognitoUser({\r\n      Username: email,\r\n      Pool: AuthorUserPool,\r\n    });\r\n\r\n    const authorAuthDetails = new AuthenticationDetails({\r\n      Username: email,\r\n      Password: password,\r\n    });\r\n\r\n    authorUser.authenticateUser(authorAuthDetails, {\r\n      onSuccess: (data) => {\r\n        setAuthorLoggedIn(true);\r\n      },\r\n      onFailure: (err) => {\r\n        setAuthorLoggedIn(false);\r\n      },\r\n      newPasswordRequired: (data) => {},\r\n    });\r\n  };\r\n\r\n  // console.log(Auth.isAuthProtected());\r\n  console.log(localStorage.getItem(\"jwtToken\"));\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Container fluid className=\"p-0\">\r\n        <Row className=\"g-0\">\r\n          <Col lg={4}>\r\n            <div className=\"authentication-page-content p-4 d-flex align-items-center min-vh-100\">\r\n              <div className=\"w-100\">\r\n                <Row className=\"justify-content-center\">\r\n                  <Col lg={9}>\r\n                    <div>\r\n                      <div className=\"text-center\">\r\n                        <div>\r\n                          <img\r\n                            src={Logo}\r\n                            alt=\"\"\r\n                            height=\"100\"\r\n                            class=\"auth-logo logo-dark mx-auto\"\r\n                          />\r\n                        </div>\r\n\r\n                        <h4 className=\"font-size-18 mt-4\">Welcome Back!</h4>\r\n                        <p className=\"text-muted\">\r\n                          Sign in to continue to Pet Pawnions.\r\n                        </p>\r\n                      </div>\r\n                      {step === 0 ? (\r\n                        <h1>\r\n                          <div\r\n                            className=\"user-type\"\r\n                            style={{\r\n                              display: \"flex\",\r\n                              flexDirection: \"column\",\r\n                            }}\r\n                          >\r\n                            <Button\r\n                              color=\"success\"\r\n                              className=\"w-md waves-effect waves-light\"\r\n                              type=\"submit\"\r\n                              onClick={() => {\r\n                                setUserType(\"Admin\");\r\n                                setStep(1);\r\n                              }}\r\n                            >\r\n                              Log In as an Admin\r\n                            </Button>\r\n                            <h2\r\n                              style={{\r\n                                width: \"100%\",\r\n                                textAlign: \"center\",\r\n                                borderBottom: \"1px solid #9A9483\",\r\n                                lineHeight: \"0.1em\",\r\n                                margin: \"20px 0 25px\",\r\n                                opacity: \"50%\",\r\n                              }}\r\n                            >\r\n                              <span\r\n                                style={{\r\n                                  backgroundColor: \"#f0f5f7\",\r\n                                  padding: \"0 15px\",\r\n                                  fontSize: \"12px\",\r\n                                }}\r\n                              >\r\n                                OR\r\n                              </span>\r\n                            </h2>\r\n                            <Button\r\n                              color=\"primary\"\r\n                              className=\"w-md waves-effect waves-light\"\r\n                              type=\"submit\"\r\n                              onClick={() => {\r\n                                setUserType(\"Author\");\r\n                                setStep(1);\r\n                              }}\r\n                            >\r\n                              Log In as an Author\r\n                            </Button>\r\n                          </div>\r\n                        </h1>\r\n                      ) : null}\r\n                      {step === 1 ? (\r\n                        <div className=\"login-flow\">\r\n                          {adminLoggedIn ? (\r\n                            <div>\r\n                              {setTimeout(() => {\r\n                                setRedirect(true);\r\n                              }, 2000)}\r\n                              {redirect ? <Redirect to=\"/articles\" /> : null}\r\n                            </div>\r\n                          ) : null}\r\n                          {adminLoggedIn === false ? (\r\n                            <UncontrolledAlert\r\n                              color=\"danger\"\r\n                              className=\"alert-dismissible fade show\"\r\n                              role=\"alert\"\r\n                            >\r\n                              <i className=\"mdi mdi-alert-outline me-2\"></i>\r\n                              Authentication failed! Please try again\r\n                            </UncontrolledAlert>\r\n                          ) : null}\r\n                          {authorLoggedIn ? (\r\n                            <div>\r\n                              {setTimeout(() => {\r\n                                setRedirect(true);\r\n                              }, 2000)}\r\n                              {redirect ? <Redirect to=\"/dashboard\" /> : null}\r\n                            </div>\r\n                          ) : null}\r\n                          {authorLoggedIn === false ? (\r\n                            <UncontrolledAlert\r\n                              color=\"danger\"\r\n                              className=\"alert-dismissible fade show\"\r\n                              role=\"alert\"\r\n                            >\r\n                              <i className=\"mdi mdi-alert-outline me-2\"></i>\r\n                              Authentication failed! Please try again\r\n                            </UncontrolledAlert>\r\n                          ) : null}\r\n\r\n                          <div className=\"p-2 mt-5\">\r\n                            <AvForm className=\"form-horizontal\">\r\n                              <div className=\"auth-form-group-custom mb-4\">\r\n                                <i className=\"ri-user-2-line auti-custom-input-icon\"></i>\r\n                                <Label htmlFor=\"username\">Email</Label>\r\n                                <AvField\r\n                                  name=\"email\"\r\n                                  type=\"text\"\r\n                                  className=\"form-control\"\r\n                                  id=\"username\"\r\n                                  placeholder=\"Enter username\"\r\n                                  onChange={(e) => setEmail(e.target.value)}\r\n                                />\r\n                              </div>\r\n\r\n                              <div className=\"auth-form-group-custom mb-4\">\r\n                                <i className=\"ri-lock-2-line auti-custom-input-icon\"></i>\r\n                                <Label htmlFor=\"userpassword\">Password</Label>\r\n                                <AvField\r\n                                  name=\"password\"\r\n                                  type=\"password\"\r\n                                  className=\"form-control\"\r\n                                  id=\"userpassword\"\r\n                                  placeholder=\"Enter password\"\r\n                                  onChange={(e) => setPassword(e.target.value)}\r\n                                />\r\n                              </div>\r\n\r\n                              <div\r\n                                className=\"mt-4 text-center\"\r\n                                style={{\r\n                                  display: \"flex\",\r\n                                  justifyContent: \"space-evenly\",\r\n                                }}\r\n                              >\r\n                                {userType === \"Admin\" ? (\r\n                                  <Button\r\n                                    color=\"success\"\r\n                                    className=\"w-md waves-effect waves-light\"\r\n                                    type=\"submit\"\r\n                                    onClick={userAuth}\r\n                                  >\r\n                                    Log In\r\n                                  </Button>\r\n                                ) : null}\r\n                                {userType === \"Author\" ? (\r\n                                  <Button\r\n                                    color=\"primary\"\r\n                                    className=\"w-md waves-effect waves-light\"\r\n                                    type=\"submit\"\r\n                                    onClick={authorLogin}\r\n                                  >\r\n                                    Log In\r\n                                  </Button>\r\n                                ) : null}\r\n                              </div>\r\n\r\n                              <div\r\n                                className=\"mt-4 text-center\"\r\n                                onClick={() => setStep(3)}\r\n                                style={{ cursor: \"pointer\" }}\r\n                              >\r\n                                <i className=\"mdi mdi-lock me-1\"></i> Forgot\r\n                                your password?\r\n                              </div>\r\n                            </AvForm>\r\n                          </div>\r\n                        </div>\r\n                      ) : null}\r\n                      {step === 3 && userType !== \"\" ? (\r\n                        <ForgetPasswordPage user={userType} />\r\n                      ) : null}\r\n                    </div>\r\n                  </Col>\r\n                </Row>\r\n              </div>\r\n            </div>\r\n          </Col>\r\n          <Col lg={8}>\r\n            <div className=\"authentication-bg\">\r\n              <div className=\"bg-overlay\"></div>\r\n            </div>\r\n          </Col>\r\n        </Row>\r\n      </Container>\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}